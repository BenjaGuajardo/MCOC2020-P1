from sympy import Symbol, diff, sqrt
from legendre_np import legendre
x = Symbol('xc[0]')
y = Symbol('xc[1]')
z = Symbol('xc[2]')
J4 = Symbol('J4')
J5 = Symbol('J5')
J6 = Symbol('J6')
J7 = Symbol('J7')
J8 = Symbol('J8')

r = sqrt(x**2+y**2+z**2)

sinθ = z/r

''' ZONALES '''

u = 0

N = [4,5,6,7,8]

J = [J4,J5,J6,J7,J8]

#for i in N:
#    u = legendre(0,i,sinθ)/r**(i+1)

i = 8
u = legendre(0,i,sinθ)/r**(i+1)

Fx = u.diff(x)
Fy = u.diff(y)
Fz = u.diff(z)

print (f'FJ{i}[0] =',Fx)
print (f'FJ{i}[1] =',Fy)
print (f'FJ{i}[2] =',Fz)

'''
FJ4 = zeros(3)
FJ4[0] = -5*xc[0]*(35*xc[2]**4/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)**2) - 15*xc[2]**2/(4*(xc[0]**2 + xc[1]**2 + xc[2]**2)) + 0.375)/(xc[0]**2 + xc[1]**2 + xc[2]**2)**(7/2) + (-35*xc[0]*xc[2]**4/(2*(xc[0]**2 + xc[1]**2 + xc[2]**2)**3) + 15*xc[0]*xc[2]**2/(2*(xc[0]**2 + xc[1]**2 + xc[2]**2)**2))/(xc[0]**2 + xc[1]**2 + xc[2]**2)**(5/2)
FJ4[1] = -5*xc[1]*(35*xc[2]**4/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)**2) - 15*xc[2]**2/(4*(xc[0]**2 + xc[1]**2 + xc[2]**2)) + 0.375)/(xc[0]**2 + xc[1]**2 + xc[2]**2)**(7/2) + (-35*xc[1]*xc[2]**4/(2*(xc[0]**2 + xc[1]**2 + xc[2]**2)**3) + 15*xc[1]*xc[2]**2/(2*(xc[0]**2 + xc[1]**2 + xc[2]**2)**2))/(xc[0]**2 + xc[1]**2 + xc[2]**2)**(5/2)
FJ4[2] = -5*xc[2]*(35*xc[2]**4/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)**2) - 15*xc[2]**2/(4*(xc[0]**2 + xc[1]**2 + xc[2]**2)) + 0.375)/(xc[0]**2 + xc[1]**2 + xc[2]**2)**(7/2) + (-35*xc[2]**5/(2*(xc[0]**2 + xc[1]**2 + xc[2]**2)**3) + 25*xc[2]**3/(xc[0]**2 + xc[1]**2 + xc[2]**2)**2 - 15*xc[2]/(2*(xc[0]**2 + xc[1]**2 + xc[2]**2)))/(xc[0]**2 + xc[1]**2 + xc[2]**2)**(5/2)

FJ5 = zeros(3)
FJ5[0] = -6*xc[0]*(63*xc[2]**5/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(5/2)) - 35*xc[2]**3/(4*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(3/2)) + 15*xc[2]/(8*sqrt(xc[0]**2 + xc[1]**2 + xc[2]**2)))/(xc[0]**2 + xc[1]**2 + xc[2]**2)**4 + (-315*xc[0]*xc[2]**5/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(7/2)) + 105*xc[0]*xc[2]**3/(4*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(5/2)) - 15*xc[0]*xc[2]/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(3/2)))/(xc[0]**2 + xc[1]**2 + xc[2]**2)**3
FJ5[1] = -6*xc[1]*(63*xc[2]**5/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(5/2)) - 35*xc[2]**3/(4*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(3/2)) + 15*xc[2]/(8*sqrt(xc[0]**2 + xc[1]**2 + xc[2]**2)))/(xc[0]**2 + xc[1]**2 + xc[2]**2)**4 + (-315*xc[1]*xc[2]**5/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(7/2)) + 105*xc[1]*xc[2]**3/(4*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(5/2)) - 15*xc[1]*xc[2]/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(3/2)))/(xc[0]**2 + xc[1]**2 + xc[2]**2)**3
FJ5[2] = -6*xc[2]*(63*xc[2]**5/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(5/2)) - 35*xc[2]**3/(4*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(3/2)) + 15*xc[2]/(8*sqrt(xc[0]**2 + xc[1]**2 + xc[2]**2)))/(xc[0]**2 + xc[1]**2 + xc[2]**2)**4 + (-315*xc[2]**6/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(7/2)) + 525*xc[2]**4/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(5/2)) - 225*xc[2]**2/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(3/2)) + 15/(8*sqrt(xc[0]**2 + xc[1]**2 + xc[2]**2)))/(xc[0]**2 + xc[1]**2 + xc[2]**2)**3

FJ6 = zeros(3)
FJ6[0] = -7*xc[0]*(231*xc[2]**6/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**3) - 315*xc[2]**4/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**2) + 105*xc[2]**2/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)) - 0.3125)/(xc[0]**2 + xc[1]**2 + xc[2]**2)**(9/2) + (-693*xc[0]*xc[2]**6/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)**4) + 315*xc[0]*xc[2]**4/(4*(xc[0]**2 + xc[1]**2 + xc[2]**2)**3) - 105*xc[0]*xc[2]**2/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)**2))/(xc[0]**2 + xc[1]**2 + xc[2]**2)**(7/2)
FJ6[1] = -7*xc[1]*(231*xc[2]**6/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**3) - 315*xc[2]**4/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**2) + 105*xc[2]**2/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)) - 0.3125)/(xc[0]**2 + xc[1]**2 + xc[2]**2)**(9/2) + (-693*xc[1]*xc[2]**6/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)**4) + 315*xc[1]*xc[2]**4/(4*(xc[0]**2 + xc[1]**2 + xc[2]**2)**3) - 105*xc[1]*xc[2]**2/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)**2))/(xc[0]**2 + xc[1]**2 + xc[2]**2)**(7/2)
FJ6[2] = -7*xc[2]*(231*xc[2]**6/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**3) - 315*xc[2]**4/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**2) + 105*xc[2]**2/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)) - 0.3125)/(xc[0]**2 + xc[1]**2 + xc[2]**2)**(9/2) + (-693*xc[2]**7/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)**4) + 1323*xc[2]**5/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)**3) - 735*xc[2]**3/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)**2) + 105*xc[2]/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)))/(xc[0]**2 + xc[1]**2 + xc[2]**2)**(7/2)

FJ7 = zeros(3)
FJ7[0] = -8*xc[0]*(429*xc[2]**7/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(7/2)) - 693*xc[2]**5/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(5/2)) + 315*xc[2]**3/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(3/2)) - 35*xc[2]/(16*sqrt(xc[0]**2 + xc[1]**2 + xc[2]**2)))/(xc[0]**2 + xc[1]**2 + xc[2]**2)**5 + (-3003*xc[0]*xc[2]**7/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(9/2)) + 3465*xc[0]*xc[2]**5/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(7/2)) - 945*xc[0]*xc[2]**3/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(5/2)) + 35*xc[0]*xc[2]/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(3/2)))/(xc[0]**2 + xc[1]**2 + xc[2]**2)**4
FJ7[1] = -8*xc[1]*(429*xc[2]**7/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(7/2)) - 693*xc[2]**5/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(5/2)) + 315*xc[2]**3/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(3/2)) - 35*xc[2]/(16*sqrt(xc[0]**2 + xc[1]**2 + xc[2]**2)))/(xc[0]**2 + xc[1]**2 + xc[2]**2)**5 + (-3003*xc[1]*xc[2]**7/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(9/2)) + 3465*xc[1]*xc[2]**5/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(7/2)) - 945*xc[1]*xc[2]**3/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(5/2)) + 35*xc[1]*xc[2]/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(3/2)))/(xc[0]**2 + xc[1]**2 + xc[2]**2)**4
FJ7[2] = -8*xc[2]*(429*xc[2]**7/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(7/2)) - 693*xc[2]**5/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(5/2)) + 315*xc[2]**3/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(3/2)) - 35*xc[2]/(16*sqrt(xc[0]**2 + xc[1]**2 + xc[2]**2)))/(xc[0]**2 + xc[1]**2 + xc[2]**2)**5 + (-3003*xc[2]**8/(16*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(9/2)) + 1617*xc[2]**6/(4*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(7/2)) - 2205*xc[2]**4/(8*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(5/2)) + 245*xc[2]**2/(4*(xc[0]**2 + xc[1]**2 + xc[2]**2)**(3/2)) - 35/(16*sqrt(xc[0]**2 + xc[1]**2 + xc[2]**2)))/(xc[0]**2 + xc[1]**2 + xc[2]**2)**4

FJN = J4*FJ4 + J5*FJ5 + J6*FJ6 + J7*FJ7
'''